import"https://cdn.skypack.dev/leaflet@1.7.1";import"https://cdn.skypack.dev/leaflet-rotate@0.1.4";import"https://cdn.skypack.dev/jquery";import"https://maxwell-ilai.github.io/Leaflet.SidePanel/dist/leaflet-sidepanel.min.js";import"https://ppete2.github.io/Leaflet.PolylineMeasure/Leaflet.PolylineMeasure.js";import"https://unpkg.com/leaflet-geotag-photo/dist/Leaflet.GeotagPhoto.min.js";const Ne=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}};Ne();var De=202407081555e-4;const Ae=[{catID:"BASE",en:"Base Map",fr:"Carte de base",es:"Mapa base"},{catID:"TOPO",en:"Topography",fr:"Topographie",es:"topogr\xE1fico"},{catID:"IMGE",en:"Imagery",fr:"Imagerie",es:"Im\xE1genes"},{catID:"TRAN",en:"Transport",fr:"Transport",es:"Transporte"},{catID:"MISC",en:"Miscelaneoud",fr:"Divers",es:"Miscel\xE1neas"}],Pe=[{providerKeyName:"Thunderforest",providerKeyValue:"538d4534960f4226bb8ca146e7df3941"},{providerKeyName:"jawg",providerKeyValue:"e9xKxlmCUuPGGQvk3FYwqWWmXgyvomdDUECpkBfjQA1obipCjNRKwWlHd1pYr5K2"},{providerKeyName:"tracestrack",providerKeyValue:"8e2a46ccbd594da9395b97cf521da27a"},{providerKeyName:"stadiamaps",providerKeyValue:"b47c1f97-1372-4024-b0cf-d60b46bb1787"},{providerKeyName:"here",providerKeyValue:"NHG82qG2ayXOLV2PQKbPG1Pbt393JTTJ-oX8KkZMdyw"}],Ze=[{BMKey:0,catID:"BASE",url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'OSM Mapnik <a href="http://www.openstreetmap.org/copyright">OpenStreetMap ORG</a>',minZoom:1,maxZoom:19,BMname:"Open Street Map",BMicon:"Mapnik.png"},{BMKey:3,catID:"BASE",url:"//{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",attribution:'Map data \xA9 <a href="http://openstreetmap.org">OpenStreetMap FR</a> contributors',maxZoom:20,minZoom:0,BMname:"OSM France",BMicon:"osmFR.png"},{BMKey:1,catID:"BASE",url:"https://tile.jawg.io/4284c312-895e-4aa5-9c79-c8974c53f9d3/{z}/{x}/{y}{r}.png?access-token={key}",keyProvider:"jawg",BMname:"Jawn GB",BMicon:"Jawg_GBMain.png",minZoom:0,maxZoom:22,subdomains:"abcd",attribution:'<a href="http://jawg.io" title="Tiles Courtesy of Jawg Maps" target="_blank">&copy; <b>Jawg</b>Maps</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},{BMKey:2,catID:"BASE",url:"http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",subdomains:["mt0","mt1","mt2","mt3"],BMname:"Google Map",BMicon:"GoogleMap.png",attribution:'<a href="https://maps.google.com">google Map</a>',maxZoom:20},{BMKey:7,catID:"BASE",url:"https://{s}.tile.thunderforest.com/neighbourhood/{z}/{x}/{y}.png?apikey={key}",attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',keyProvider:"Thunderforest",maxZoom:22,BMname:"Thunderforest Neighbourhood",BMicon:"Thunderforest_Neighbourhood.png"},{BMKey:6,catID:"BASE",url:"https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPCy",BMname:"National Geographic",BMicon:"Esri_NatGeoWorldMap.png"},{BMKey:5,catID:"BASE",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community",BMname:"ESRI Street",BMicon:"ESRIMap.png"},{BMKey:4,catID:"BASE",url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr" target="_blank">OpenStreetMap France</a>',maxZoom:19,BMname:"Humanitarian OSM",BMicon:"osmHOT.png"},{BMKey:25,catID:"TOPO",url:"https://tile.tracestrack.com/topo_fr/{z}/{x}/{y}.png?key={key}",keyProvider:"tracestrack",BMname:"Tracestack Topo",BMicon:"Tracestrack_Topo.png",attribution:'Data: \xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>, <a href="https://worldcover2021.esa.int">ESA WorldCover</a>; Maps \xA9 <a href="https://www.tracestrack.com/">Tracestrack</a>',minZoom:0,maxZoom:19},{BMKey:8,catID:"TOPO",url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",maxZoom:17,attribution:'Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)',BMname:"Open Topo Map",BMicon:"OpenTopoMap.png"},{BMKey:11,catID:"TOPO",url:"http://{s}.google.com/vt/lyrs=p&x={x}&y={y}&z={z}",subdomains:["mt0","mt1","mt2","mt3"],BMname:"Google Terrain",BMicon:"GoogleTerrain.png",attribution:'<a href="https://maps.google.com">google Map</a>'},{BMKey:12,catID:"TOPO",url:"https://tiles.stadiamaps.com/tiles/stamen_terrain/{z}/{x}/{y}.{ext}",attribution:'Map tiles by <a href="http://stadiamaps.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',subdomains:"abcd",minZoom:1,maxZoom:18,ext:"png",BMname:"Stamen Terrain",BMicon:"Stamen_Terrain.png"},{BMKey:9,catID:"TOPO",url:"https://{s}.tile.thunderforest.com/outdoors/{z}/{x}/{y}.png?apikey={key}",attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',keyProvider:"Thunderforest",maxZoom:22,BMname:"Thunderforest Outdoors",BMicon:"Thunderforest_Outdoors.png"},{BMKey:10,catID:"TOPO",url:"https://{s}.tile.thunderforest.com/landscape/{z}/{x}/{y}.png?apikey={key}",attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',keyProvider:"Thunderforest",maxZoom:22,BMname:"Thunderforest Landscape",BMicon:"Thunderforest_Landscape.png"},{BMKey:13,catID:"TOPO",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community",BMname:"ESRI Topo",BMicon:"ESRITopo.png"},{BMKey:14,catID:"IMGE",url:"http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",subdomains:["mt0","mt1","mt2","mt3"],BMname:"Google Satellite",BMicon:"GoogleSat.png",minZoom:1,maxZoom:21,attribution:'<a href="https://maps.google.com">google Map</a>'},{BMKey:3026,catID:"IMGE",url:"https://1.aerial.maps.ls.hereapi.com/maptile/2.1/maptile/newest/satellite.day/{z}/{x}/{y}/512/jpg?apiKey={key}",attribution:"Here Map",minZoom:1,maxZoom:19,BMname:"Here Satellite",BMicon:"Here_Satellite.jpg",keyProvider:"here"},{BMKey:15,catID:"IMGE",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",BMname:"ESRI Image",BMicon:"ESRIImg.png",minZoom:1,maxZoom:21,attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"},{BMKey:21,catID:"TRAN",url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}{r}.png",attribution:'<a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:20,BMname:"CartoDB Voyager",BMicon:"CartoDB_VoyagerLabelsUnder.png"},{BMKey:17,catID:"TRAN",url:"https://{s}.tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey={key}",attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',keyProvider:"Thunderforest",maxZoom:22,BMname:"Thunderforest Transport",BMicon:"Thunderforest_Transport.png"},{BMKey:20,catID:"TRAN",url:"https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey={key}",attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',keyProvider:"Thunderforest",maxZoom:22,BMname:"Thunderforest Cycle",BMicon:"Thunderforest_OpenCycleMap.png"},{BMKey:19,catID:"TRAN",url:"https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png",maxZoom:20,attribution:'<a href="https://github.com/cyclosm/cyclosm-cartocss-style/releases" title="CyclOSM - Open Bicycle render">CyclOSM</a> | Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',BMname:"Cyclo OSM",BMicon:"CyclOSM.png"},{BMKey:16,catID:"TRAN",url:"https://{s}.tile.thunderforest.com/mobile-atlas/{z}/{x}/{y}.png?apikey={key}",attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',keyProvider:"Thunderforest",maxZoom:22,BMname:"Thunderforest Mobile Atlas",BMicon:"Thunderforest_MobileAtlas.png"},{BMKey:18,catID:"TRAN",url:"https://{s}.tile.thunderforest.com/transport-dark/{z}/{x}/{y}.png?apikey={key}",attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',keyProvider:"Thunderforest",maxZoom:22,BMname:"Thunderforest Transport Dark",BMicon:"Thunderforest_TransportDark.png"},{BMKey:27,catID:"MISC",url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",minZoom:0,maxZoom:20,BMname:"CartoDB Positron",BMicon:"CartoDB_Positron.png"},{BMKey:23,catID:"MISC",url:"https://tiles.stadiamaps.com/tiles/stamen_toner_lite/{z}/{x}/{y}{r}.{ext}",BMname:"Stamen Toner Lite",BMicon:"Stamen_TonerLite.png",attribution:'Map tiles by <a href="http://stadiamaps.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',subdomains:"abcd",minZoom:0,maxZoom:20,ext:"png"},{BMKey:22,catID:"MISC",url:"https://{s}.tile.thunderforest.com/pioneer/{z}/{x}/{y}.png?apikey={key}",attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',keyProvider:"Thunderforest",maxZoom:22,BMname:"Thunderforest Pioneer",BMicon:"Thunderforest_Pioneer.png"},{BMKey:24,catID:"MISC",url:"https://tiles.stadiamaps.com/tiles/stamen_watercolor/{z}/{x}/{y}.{ext}",attribution:'Map tiles by <a href="http://stadiamaps.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',subdomains:"abcd",minZoom:1,maxZoom:16,ext:"jpg",BMname:"Stamen Watercolor",BMicon:"Stamen_Watercolor.jpg"}],ze=[{BMKey:5001,url:"https://tile.tracestrack.com/bicycle-route/{z}/{x}/{y}.png?key={key}",keyProvider:"tracestrack",BMname:"Tracestrack Bike",BMicon:"Tracestrack_Bike.png",attribution:'Data: \xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>, <a href="https://worldcover2021.esa.int">ESA WorldCover</a>; Maps \xA9 <a href="https://www.tracestrack.com/">Tracestrack</a>',minZoom:8,maxZoom:19},{BMKey:5e3,url:"https://tile.tracestrack.com/subway-route/{z}/{x}/{y}.png?key={key}",keyProvider:"tracestrack",BMname:"Tracestrack Subway",BMicon:"Tracestrack_Subway.png",attribution:'Data: \xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>, <a href="https://worldcover2021.esa.int">ESA WorldCover</a>; Maps \xA9 <a href="https://www.tracestrack.com/">Tracestrack</a>',minZoom:8,maxZoom:19},{BMKey:5002,url:"https://tile.tracestrack.com/bus-route/{z}/{x}/{y}.png?key={key}",keyProvider:"tracestrack",BMname:"Tracestrack Bus",BMicon:"Tracestrack_Bus.png",attribution:'Data: \xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>, <a href="https://worldcover2021.esa.int">ESA WorldCover</a>; Maps \xA9 <a href="https://www.tracestrack.com/">Tracestrack</a>',minZoom:8,maxZoom:19},{BMKey:5003,url:"https://tile.tracestrack.com/train-route/{z}/{x}/{y}.png?key={key}",keyProvider:"tracestrack",BMname:"Tracestrack Train",BMicon:"Tracestrack_Train.png",attribution:'Data: \xA9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap contributors</a>, <a href="https://worldcover2021.esa.int">ESA WorldCover</a>; Maps \xA9 <a href="https://www.tracestrack.com/">Tracestrack</a>',minZoom:0,maxZoom:19},{BMKey:5004,url:"https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png",BMname:"Open Sea Map",BMicon:"openseamap.png",attribution:'Map data: &copy; <a href="http://www.openseamap.org">OpenSeaMap</a> contributors',minZoom:8}];var C={categories:Ae,providerKeys:Pe,layers:Ze,overlays:ze};const Ke=10,Fe=46.80960630088855,$e=-71.21267080307008,Ge=0,Re=!1,Ue=25,He="New map";var b={z:Ke,lat:Fe,lng:$e,rot:Ge,m:Re,l:Ue,t:He};const _e={languages:{en:"English",fr:"Fran\xE7ais",es:"Espa\xF1ol"},fallback:"en"},qe={youhere:{fr:"Vous \xEAtes ici",en:"You are here",es:"Usted est\xE1 aqu\xED"},expjson:{fr:"Exporter en JSON",en:"Export to JSON",es:"Exportar a JSON"},impfavfile:{fr:"Importer le fichier des favoris",en:"Import favorites file",es:"Importar archivo de favoritos"},selfav:{en:"Select file",es:"Seleccione Archivo",fr:"Choisir le fichier"},cancel:{en:"Cancel",es:"Cancelar",fr:"Annuler"},upload:{en:"Upload",fr:"T\xE9l\xE9verser",es:"Cargar"},confirm:{en:"Confirm",fr:"Confirmer",es:"Confirmar"},yes:{en:"Yes",fr:"Oui",es:"Si"},no:{en:"No",fr:"Non",es:"No"},layerselec:{en:"Map selector",fr:"S\xE9lecteur de carte",es:"Selector de mapa"},overlaysel:{en:"Overlay selector",fr:"S\xE9lecteur couche",es:"Selector de capa"},overlay:{en:"Overlay",fr:"Couche",es:"Capas"},tools:{en:"Tools",fr:"Outils",es:"Herramientas"},favplace:{en:"Favorites places",fr:"Lieux pr\xE9f\xE9r\xE9s",es:"Lugares favoritos"},aboutbm:{en:"About BestMap",fr:"\xC0 propos de BestMap",es:"Acerca de BestMap"},maptools:{en:"Map Tools",fr:"Outils cartographiques",es:"Herramientas de mapa"},search:{en:"Search",fr:"Chercher",es:"Buscar"},addrexample:{en:"99 main street, city, state, country",fr:"99 Rue untel,ville,province,pays",es:"99 Calle 12,ciudad, dept., pa\xEDs"},pref:{en:"Preferences",fr:"Pr\xE9f\xE9rences",es:"Preferencias"},save:{en:"Save",fr:"Sauvegarder",es:"Guardar"},weeelzoom:{en:"SHIFT + Mouse weel to rotate",fr:"MAJ + Molette de la souris pour faire pivoter",es:"MAY\xDAS + rueda del rat\xF3n para girar"},marker:{en:"Marker",fr:"Marqueur",es:"Marcador"},gocurpos:{en:"Go to current position",fr:"Aller \xE0 votre position actuel",es:"Ir a tu ubicaci\xF3n actual"},trackpos:{en:"Track position",fr:"Suivre la position",es:"Seguir posici\xF3n"},measure:{en:"Measure",fr:"Mesurer",es:"Medir"},openin:{en:"Open in",fr:"Ouvrir dans",es:"Abrir en"},favsaved:{en:"Favorite saved places",fr:"Lieux sauvegard\xE9s favoris",es:"Lugares guardados favoritos"},savechange:{en:"Save changes",fr:"Sauvegarder les changements",es:"Guardar"},undo:{en:"Undo",fr:"Annuler",es:"Cancelar"},impJSON:{en:"Import BestMap JSON file",fr:"Importer fichier JSON BestMap",es:"Importar archivo JSON de BestMap"},expJSON:{en:"Export to BestMap JSON file",fr:"Exporter vers fichier JSON BestMap",es:"Exportar a archivo JSON de BestMap"},expGeoJSON:{en:"Export to GeoJSON file",fr:"Exporter vers un fichier GeoJSON",es:"CanExportar a archivo GeoJSONcelar"},addviewtofav:{en:"Add current place and view",fr:"Ajouter le lieu et la vue actuels",es:"Agregar lugar y vista actual"},placename:{en:"Place Name",fr:"Nom de lieu",es:"Nombre del lugar geogr\xE1fico"},place:{en:"Place",fr:"Lieu",es:"Lugar"},golocation:{en:"View the location",fr:"Afficher",es:"Ver lugar"},view:{en:"View",fr:"",es:"Ver"},updateview:{en:"Update URL with current location and view",fr:"Mettre \xE0 jour avec l'emplacement et la vue actuel",es:"Actualizar con ubicaci\xF3n y vista actual"},update:{en:"Update",fr:"Mettre \xE0 jour",es:"Actualizar"},delplace:{en:"Delete this place",fr:"Supprimer cet endroit",es:"Eliminar este lugar"},delete:{en:"Delete",fr:"Supprimer",es:"Eliminar"},chooselang:{en:"Choose a language:",fr:"Choisissez une langue",es:"Seleccione un idioma:"},author:{en:"Author:",fr:"Auteur:",es:"Autor:"},mapname:{en:"Place Name",fr:"Lieu",es:"Lugar"},basemap:{en:"Base Map:",fr:"Carte de base:",es:"Mapa base:"},lat:{en:"Latitude:",fr:"Latitude:",es:"Latitud:"},lng:{en:"Longitude:",fr:"Longitude:",es:"Longitud:"},zoom:{en:"Zoom:",fr:"Zoom:",es:"Zoom"},bmid:{en:"Base Map ID:",fr:"ID Carte de base:",es:"ID Mapa base"},editcurpos:{en:"Edit Current Position:",fr:"Modifier la vue actuelle:",es:"Editar posici\xF3n actual"},shareclipboard:{en:"Share to Clipboard:",fr:"Partager dans le presse-papiers ::",es:"Compartir en el portapapeles:"},shareemail:{en:"Share by e-mail:",fr:"Partager par courriel:",es:"Compartir por correo electr\xF3nico:"},doupdateview:{en:"Do you update the saved view for: $1",fr:"Mettez-vous \xE0 jour la vue enregistr\xE9e pour $1 ?",es:"\xBFActualiza la vista guardada para: $1 ?"}};var p={language:_e,labels:qe};const q={defaultState:0,url:1,device:2};var m={lang:"fr"};be();var de=q.defaultState,ue="hsl(197, 100%, 60%)",Je=window.location.search,d=new URLSearchParams(Je),pe=d.has("z")==!0?Number(d.get("z")):b.z,me=d.has("lat")==!0?Number(d.get("lat")):b.lat,fe=d.has("lng")==!0?Number(d.get("lng")):b.lng,ge=d.has("rot")==!0?Number(d.get("rot")):b.rot,re=d.has("m")==!0?d.get("m").toString()=="true":b.m,ye=d.has("t")==!0?d.get("t"):b.t,ve=d.has("l")==!0?d.get("l"):b.l;const Ve=1e3;d.has("lat")==!0&&d.has("lng")==!0&&(de=q.url);var v=[];for(const e of C.categories){var H={catID:e.catID,category:m.lang=="fr"?e.fr:e.en,layers:[]};for(const t of C.layers)if(t.catID==H.catID){var O=t.url;if(t.keyProvider!==void 0){var x=Ie(t.keyProvider);x!==void 0&&(O=t.url.replace("{key}",x))}var l=L.tileLayer(O,{});t.BMKey!==void 0&&(l.options.BMKey=t.BMKey),t.BMname!==void 0&&(l.options.BMname=t.BMname),t.BMicon!==void 0&&(l.options.BMicon=t.BMicon),t.BMicon!==void 0&&(l.options.BMicon=t.BMicon),t.attribution!==void 0&&(l.options.attribution=t.attribution),t.minZoom!==void 0?l.options.minZoom=t.minZoom:l.options.minZoom=0,t.maxZoom!==void 0?l.options.maxZoom=t.maxZoom:l.options.maxZoom=22,t.subdomains!==void 0&&(l.options.subdomains=t.subdomains),t.ext!==void 0&&(l.options.ext=t.ext),l.options.isOverlay=!1,l.options.pane="tilePane",H.layers.push(l)}v.push(H)}var J=[];for(const e of C.overlays){var O=e.url;if(e.keyProvider!==void 0){var x=Ie(e.keyProvider);x!==void 0&&(O=e.url.replace("{key}",x))}var l=L.tileLayer(O,{});e.BMKey!==void 0&&(l.options.BMKey=e.BMKey),e.BMname!==void 0&&(l.options.BMname=e.BMname),e.BMicon!==void 0&&(l.options.BMicon=e.BMicon),e.BMicon!==void 0&&(l.options.BMicon=e.BMicon),e.attribution!==void 0&&(l.options.attribution=e.attribution),e.minZoom!==void 0&&(l.options.minZoom=e.minZoom),e.maxZoom!==void 0&&(l.options.maxZoom=e.maxZoom),e.subdomains!==void 0&&(l.options.subdomains=e.subdomains),e.ext!==void 0&&(l.options.ext=e.ext),l.options.isOverlay=!0,l.options.pane="overlayPane",J.push(l)}var n=L.map("map",{center:new L.LatLng(me,fe),zoom:pe,zoomControl:!1,rotate:!0,touchRotate:!0,rotateControl:!1,BMHasMarker:!1,BMTitle:ye,bearing:ge,attributionControl:!0,BMHasMeasure:!1,BMHasTracker:!1,BMCurrentLayerKey:0}),g={},je=Q(ve);n.addLayer(je);document.getElementById("buildFld").value=De;L.control.sidepanel("panelID",{panelPosition:"left",hasTabs:!0,tabsPosition:"top",pushControls:!0,darkMode:!0,startTab:"tab-layer"}).addTo(n);var he=L.control({position:"topright"});he.onAdd=function(e){var t=L.DomUtil.create("div","info legend nArrow");return t.innerHTML="\u27F4",t};he.addTo(n);var We=document.querySelector(".nArrow");We.addEventListener("click",function(e){n.setBearing(0)});let Me=L.control.polylineMeasure({position:"topright",unit:"kilometres",showBearings:!1,clearMeasurementsOnStop:!0,showClearControl:!1,showUnitControl:!1,startCircle:{color:"#000",weight:2,fillColor:"#0f0",fillOpacity:1,radius:6},intermedCircle:{color:"#000",weight:2,fillColor:"#ff0",fillOpacity:1,radius:4},currentCircle:{color:"#000",weight:1,fillColor:"#f0f",fillOpacity:1,radius:3},endCircle:{color:"#000",weight:2,fillColor:"#f00",fillOpacity:1,radius:6},tempLine:{color:"#00f",weight:1},fixedLine:{color:"#00C",weight:3}});Me.addTo(n);document.querySelector(".polyline-measure-unicode-icon").parentNode.style.display="none";n.on("rotate",function(e){F(Y(n.getBearing()))});n.on("resizeend",function(e){h(N()),M(D()),A($())});n.on("zoomend",function(e){A(n.getZoom())});n.on("moveend",function(e){h(N()),M(D())});re?Ce():G(re);ct();lt();dt();ut();Bt();bt();It();k(ye);F(ge);h(me);M(fe);A(pe);Se(ve);we(!1);ke(!1);let Be,V=!1,j=!1;var W=indexedDB.open("BestMapDB",1),w,B="BMFavorite";W.onerror=function(e){console.log("Database error: "+e.target.errorCode)};W.onsuccess=function(e){w=e.target.result,console.log("Database opened successfully"),Le()};W.onupgradeneeded=function(e){w=e.target.result;var t=w.createObjectStore(B,{keyPath:"t"});t.createIndex("m","m",{unique:!1}),t.createIndex("rot","rot",{unique:!1}),t.createIndex("l","l",{unique:!1}),t.createIndex("lat","lat",{unique:!1}),t.createIndex("lng","lng",{unique:!1}),t.createIndex("z","z",{unique:!1})};document.getElementById("dlgUpload").style.display="none";document.getElementById("dlgconfirm").style.display="none";navigator.geolocation&&de==q.defaultState&&navigator.geolocation.getCurrentPosition(tt);var Ye=document.getElementById("languageDropdown");for(var P in p.language.languages)if(p.language.languages.hasOwnProperty(P)){var Z=document.createElement("option");Z.value=P,Z.textContent=p.language.languages[P],Ye.appendChild(Z),P===m.lang&&(Z.selected=!0)}function Qe(e,t=null){let a=document.cookie.split(";");for(let o of a){let[r,i]=o.split("=").map(c=>c.trim());if(r===e)return i}return t}function Xe(e,t,a){var o="";if(a){var r=new Date;r.setTime(r.getTime()+a*24*60*60*1e3),o="; expires="+r.toUTCString()}document.cookie=e+"="+t+o+"; path=/"}function et(){var e=document.getElementById("languageDropdown");m.lang=e.value,Ee(m.lang);for(var t in m)Xe(t,m[t])}function be(){for(var e in m)m[e]=Qe(e,m[e]);Ee(m.lang);for(var t=document.getElementById("languageDropdown"),a=0;a<t.options.length;a++)if(t.options[a].value===m.lang){t.selectedIndex=a;break}}function I(e,t,a="$1",o="$2",r="$3"){var i=void 0,c=t.toLowerCase();return c in e?i=e[c]:p.language.fallback in e&&(i=e[p.language.fallback]),i=i.replace("$1",a),i=i.replace("$2",o),i=i.replace("$2",r),i}function Ee(e){let t=document.querySelectorAll("[data-label]");t.forEach(function(a){var o=a.getAttribute("data-label");if(o in p.labels){var r=I(p.labels[o],e);a.innerText=r}}),t=document.querySelectorAll("[data-title]"),t.forEach(function(a){var o=a.getAttribute("data-title");if(o in p.labels){var r=I(p.labels[o],e);a.setAttribute("title",r)}}),t=document.querySelectorAll("[data-placeholder]"),t.forEach(function(a){var o=a.getAttribute("data-placeholder");if(o in p.labels){var r=I(p.labels[o],e);a.setAttribute("placeholder",r)}}),t=document.querySelectorAll("[data-catID]"),t.forEach(function(a){var o=a.getAttribute("data-catID");for(const r of C.categories)r.catID==o&&(a.innerText=r[e])})}function tt(e){var t=e.coords,a=Te(t.accuracy);R(),n.setView(new L.LatLng(t.latitude,t.longitude),a),k(I(p.labels.youhere,m.lang))}function Ie(e){var t;for(const a of C.providerKeys)a.providerKeyName==e&&(t=a.providerKeyValue);return t}function E(e,t){var a=new URLSearchParams(window.location.search);a.set(e,t),window.history.pushState({},n.options.BMTitle,`${location.pathname}?${a.toString()}`)}function at(){return n.options.BMTitle}function k(e){n.options.BMTitle=e,document.getElementById("fTitle").value=e,document.title=`BestMap: ${e}`,n.options.BMHasMarker&&g.setTooltipContent(e),E("t",e)}function S(){return Y(n.getBearing())}function F(e){document.getElementById("fRot").value=e,E("rot",e);var t=document.querySelector(".nArrow");t.style.transform=`rotate(${e-90}deg)`,e==0?t.style.display="none":t.style.display="block"}function h(e){document.getElementById("fLat").value=e,E("lat",e)}function N(){var e;return n.options.BMHasMarker?e=g.getLatLng().lat:e=n.getCenter().lat,e}function D(){var e;return n.options.BMHasMarker?e=g.getLatLng().lng:e=n.getCenter().lng,e}function M(e){document.getElementById("fLng").value=e,E("lng",e)}function $(){return n.getZoom()}function A(e){document.getElementById("fZoom").value=e,E("z",e)}function G(e){e?(g.setTooltipContent(n.options.BMTitle),document.getElementById("btFlipMarker").style.backgroundImage="url('icons/removeMarker.png')"):document.getElementById("btFlipMarker").style.backgroundImage="url('icons/addMarker.png')",E("m",e)}function we(e){e?document.getElementById("btMeasure").style.backgroundImage="url('icons/removeMeasure.png')":document.getElementById("btMeasure").style.backgroundImage="url('icons/addMeasure.png')"}function ke(e){e?document.getElementById("btTrack").style.backgroundImage="url('icons/removeTrack.png')":document.getElementById("btTrack").style.backgroundImage="url('icons/addTrack.png')"}function Te(e){var o=18-Math.log(e)/Math.log(10);return o=Math.max(0,Math.min(o,18)),o}function ot(e){var t=e.coords,a=Te(t.accuracy);R(),n.flyTo(new L.LatLng(t.latitude,t.longitude),a),n.once("moveend zoomend",function(){ee(t.latitude,t.longitude),k(I(p.labels.youhere,m.lang))})}function rt(e){e.code==1?console.log("getCurrentPosition Error: Access is denied!"):e.code==2&&console.log("getCurrentPosition Error: Position is unavailable!")}function Y(e){var t=parseInt(e);return e<0?t=360- -e%360:t=e%360,parseInt(t)}function nt(e){var t=parseFloat(e);return t>90&&(t=90),t<-90&&(t=-90),t}function it(e){var t=parseFloat(e);return t>180&&(t=180),t<-180&&(t=-180),t}function st(e){var t=parseInt(e);return t>n.maxZoom&&(t=n.maxZoom),t<n.minZoom&&(t=n.minZoom),t}function _(e){var t=parseInt(e);isNaN(t)&&(t=0),n.eachLayer(function(a){"isOverlay"in a.options&&(a.options.isOverlay||n.removeLayer(a))}),n.addLayer(Q(t)),Se(t)}function ne(e){var t=parseInt(e);if(!isNaN(t)){var a=!0,o=document.getElementById(`BMOverlay-${t}`),r=o.getElementsByTagName("img")[0];if(n.eachLayer(function(i){i.options.BMKey==t&&(a=!1,n.removeLayer(i),r.style.borderColor="black")}),a)for(const i of J)i.options.BMKey==t&&(n.addLayer(i),r.style.borderColor=ue)}}function lt(){var e=document.getElementById("BM-Overlay-Nav-Panel"),t='<div class="BM-Layer-Nav-Container">';for(const o of J){var a=`BMOverlay-${o.options.BMKey}`;t+=`<div class="BM-Over-Bt" id="${a}" data-bmkey="${o.options.BMKey}" >
              <img src='layerIcons/${o.options.BMicon}' title='${o.options.BMname}'>
              <div class="BM-Layer-Bt-Name">${o.options.BMname}</div>
            </div>`}t+="</div>",e.innerHTML=t}function ct(){for(var e=document.getElementById("BM-Layer-Nav-Panel"),t=0,a=0;a<v.length;a++){for(var o='<div class="BM-Layer-Nav-Container">',r=v[a].layers,i=0;i<r.length;i++){var c=`BMLayer-${t}`;o+=`<div class="BM-Layer-Bt" id="${c}" data-bmkey="${v[a].layers[i].options.BMKey}" >
              <img src='layerIcons/${r[i].options.BMicon}' title='${v[a].layers[i].options.BMname}'>
              <div class="BM-Layer-Bt-Name">${v[a].layers[i].options.BMname}</div>
            </div>`,t++}o+="</div>";var f=`<div class="BM-Layer-Nav-Category" data-catID="${v[a].catID}"  >${v[a].category}</div>${o}`;e.innerHTML+=f}}function Q(e){var t,a,o=parseInt(e);isNaN(o)&&(o=0);for(var r=0;r<v.length;r++){a=v[r].layers;for(var i=0;i<a.length;i++)r===0&&i===0&&(t=a[i]),a[i].options.BMKey===o&&(t=a[i])}return t}function Se(e){for(var t=document.querySelectorAll(".BM-Layer-Bt"),a=0;a<t.length;a++){var o=t[a].getElementsByTagName("img")[0];t[a].dataset.bmkey==e?o.style.borderColor=ue:o.style.borderColor="black"}document.getElementById("fLayer").value=Q(e).options.BMname,document.getElementById("fLayerID").value=e,E("l",e),n.options.BMCurrentLayerKey=e}function dt(){document.addEventListener("click",function(e){if(e.target.matches(".BM-Layer-Bt img")){var t=e.target.parentNode.dataset.bmkey;_(t)}if(e.target.matches(".BM-Layer-Bt div")){var t=e.target.parentNode.dataset.bmkey;_(t)}},!1)}function ut(){document.addEventListener("click",function(e){if(e.target.matches(".BM-Over-Bt img")){var t=e.target.parentNode.dataset.bmkey;ne(t)}if(e.target.matches(".BM-Over-Bt div")){var t=e.target.parentNode.dataset.bmkey;ne(t)}},!1)}function z(){return n.options.BMHasMarker?g.getLatLng():n.getCenter()}const pt=document.querySelector("#btSelFavFile");pt.addEventListener("change",e=>{if(e.target.files.length==1){const[t]=e.target.files,{name:a,size:o}=t,r=(o/1e3).toFixed(2),i=`${a} (${r}KB)`;document.querySelector("#selectedFavFileName").textContent=i,document.querySelector("#btFavDoUpload").style.display="block"}else document.querySelector("#selectedFavFileName").textContent="",document.querySelector("#btFavDoUpload").style.display="none"});function mt(){document.getElementById("dlgUpload").style.display="block"}function ft(e){let t=e.target.result,a=JSON.parse(t);var o=document.getElementById("FavTableBody");o.innerHTML="";for(let i=0;i<a.length;i++){var r=a[i];X(r.t,r.m,r.rot,r.lat,r.lng,r.z,r.l)}}function gt(){document.getElementById("dlgUpload").style.display="none"}function yt(){let e=document.getElementById("btSelFavFile");if(!e.value.length)return;let t=new FileReader;t.onload=ft,t.readAsText(e.files[0]),document.getElementById("dlgUpload").style.display="none"}function ie(e,t,a){const o=document.createElement("a"),r=new Blob([e],{type:a});o.href=URL.createObjectURL(r),o.download=t,o.click()}function vt(e){var t=w.transaction([B],"readonly"),a=t.objectStore(B),o=a.getAll();o.onsuccess=function(r){var i=r.target.result;console.log("Data read successfully"),e(i)},o.onerror=function(r){console.log("Error reading data: "+r.target.errorCode)}}function Le(){vt(function(e){var t;for(t of e)X(t.t,t.m,t.rot,t.lat,t.lng,t.z,t.l);Oe("FavTable",0,!1)})}function ht(){var e=w.transaction([B],"readwrite"),t=e.objectStore(B),a=t.clear();a.onsuccess=function(o){console.log("All data deleted successfully")},a.onerror=function(o){console.log("Error deleting all data: "+o.target.errorCode)}}function Mt(e){var t=w.transaction([B],"readwrite"),a=t.objectStore(B),o=a.add(e);o.onsuccess=function(r){console.log("Data inserted successfully")},o.onerror=function(r){console.log("Error inserting data: "+r.target.errorCode)}}function X(e,t,a,o,r,i,c){const u=document.getElementById("FavTableBody").insertRow(0);var y=self.crypto.randomUUID(),T=self.crypto.randomUUID(),te=self.crypto.randomUUID(),ae=self.crypto.randomUUID(),xe=self.crypto.randomUUID(),oe="";oe=`
  <tr id="${xe}">
    <td id="${y}" class="BM-Table-Input" contenteditable="true">${e}</td>
    <td id="${T}" class="BM-Table-Icon" ><img src="./icons/favView.png"></td>
    <td id="${te}" class="BM-Table-Icon"><img src="./icons/favUpdate.png"</td>
    <td id="${ae}" class="BM-Table-Icon"><img src="./icons/favDelete.png"</td>
  </tr>`,u.innerHTML=oe,u.dataset.m=t,u.dataset.t=e,u.dataset.rot=a,u.dataset.lat=o,u.dataset.lng=r,u.dataset.z=i,u.dataset.l=c,document.getElementById(T).addEventListener("click",function(){var s=this.parentNode.dataset;R(),n.panTo({lng:Number(s.lng),lat:Number(s.lat)}),n.setZoom(s.z),A(s.z),n.setBearing(Number(s.rot)),_(Number(s.l)),n.options.BMTitle=s.t,console.log(`GB: BMHasMarker = ${n.options.BMHasMarker}`),console.log(`GB: theUrlObj = ${JSON.stringify(s)}`),console.log(`GB: theUrlObj m type = ${typeof s.m}`),s.m=="true"&&(ee(s.lat,s.lng),G(!0),n.options.BMHasMarke=!0,n.panTo({lng:Number(s.lng),lat:Number(s.lat)})),n.panTo({lng:Number(s.lng),lat:Number(s.lat)}),h(Number(s.lat)),M(Number(s.lng)),k(s.t)}),document.getElementById(te).addEventListener("click",function(){var s=this.parentNode.dataset;document.getElementById("dlgconfirm").style.display="block",document.getElementById("conQuestion").innerText=I(p.labels.doupdateview,m.lang,s.t),document.getElementById("btConfNo").addEventListener("click",function(){document.getElementById("dlgconfirm").style.display="none"}),document.getElementById("btConfYes").addEventListener("click",function(){s.m=n.options.BMHasMarker,s.rot=S(),s.lat=N(),s.lng=D(),s.z=$(),s.l=n.options.BMCurrentLayerKey,document.getElementById("dlgconfirm").style.display="none"})}),document.getElementById(ae).addEventListener("click",function(){this.parentNode.remove()}),document.getElementById(y).addEventListener("input",function(s){var U=s.target.innerText;n.options.BMTitle!==U&&k(U),this.parentNode.dataset.t=U})}function Bt(){document.getElementById("btGoOSM").addEventListener("click",function(){var e=z(),t=n.getZoom(),a=`https://www.openstreetmap.org/#map=${t}/${e.lat}/${e.lng}`;window.open(a)}),document.getElementById("btGoGoogle").addEventListener("click",function(){var e=z(),t=`https://www.google.com/maps/search/?api=1&query=${e.lat},${e.lng}`;window.open(t)}),document.getElementById("btGoGoogleEarth").addEventListener("click",function(){var e=z(),t=n.getZoom(),a=S(),o=Math.pow(2,20-t)*4096;console.log(`z=${t} d=${o}`);var r=`https://earth.google.com/web/@${e.lat},${e.lng},${o}d,${-a}h`;window.open(r)}),document.getElementById("btGoBing").addEventListener("click",function(){var e=z(),t=n.getZoom(),a=S(),o=-a,r=`https://www.bing.com/maps?cp=${e.lat}~${e.lng}&lvl=${t}&dir=${o}`;console.log(r),window.open(r)}),document.getElementById("btFavAdd").addEventListener("click",function(){X("*** name ***",n.options.BMHasMarker,S(),N(),D(),$(),n.options.BMCurrentLayerKey)}),document.getElementById("btFavSave").addEventListener("click",function(){ht();for(var e=document.getElementById("FavTableBody"),t=0,a;a=e.rows[t];t++){var o={t:a.dataset.t,m:a.dataset.m,rot:a.dataset.rot,l:a.dataset.l,lat:a.dataset.lat,lng:a.dataset.lng,z:a.dataset.z};Mt(o)}}),document.getElementById("btFavUndo").addEventListener("click",function(){var e=document.getElementById("FavTableBody");e.innerHTML="",Le()}),document.getElementById("btFavExport").addEventListener("click",function(){for(var e=document.getElementById("FavTableBody"),t=[],a=0,o;o=e.rows[a];a++){var r={t:o.dataset.t,m:o.dataset.m,rot:o.dataset.rot,l:o.dataset.l,lat:o.dataset.lat,lng:o.dataset.lng,z:o.dataset.z};t.push(r)}ie(JSON.stringify(t),"BMFavorites.json","text/plain")}),document.getElementById("btFavToGeoJSON").addEventListener("click",function(){for(var e=document.getElementById("FavTableBody"),t="",a=0,o;o=e.rows[a];a++){var r=`{
        "type": "Feature",
        "geometry": {
          "type": "Point",
          "coordinates": [${o.dataset.lng},${o.dataset.lat}]
        },
        "properties": {
          "name": "${o.dataset.t}",
          "rotation": ${o.dataset.rot},
          "tilez" : ${o.dataset.z},
          "layerid" : ${o.dataset.l},
          "hasmarker" : ${o.dataset.m}
        }
      }`;t+=a!=0?`,${r}`:r}var i=`{
      "type": "FeatureCollection",
      "features": [${t}]
    }`;ie(i,"BMFavorites.geojson","text/plain")}),document.getElementById("btFavImport").addEventListener("click",mt),document.getElementById("btFavCancelUpload").addEventListener("click",gt),document.getElementById("btFavDoUpload").addEventListener("click",yt),document.getElementById("btFlipMarker").addEventListener("click",function(){wt()}),document.getElementById("btTrack").addEventListener("click",function(){xt()}),document.getElementById("btGoHere").addEventListener("click",function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(ot,rt)}),document.getElementById("shareToClipboard").addEventListener("click",function(){navigator.clipboard.writeText(window.location.href)}),document.getElementById("shareToMail").addEventListener("click",function(){var e=encodeURIComponent(window.location.href),t=encodeURIComponent(n.options.BMTitle),a=`mailto:?subject=${t}&body=${t}%0A${e}`;document.location=a}),document.getElementById("btMeasure").addEventListener("click",function(){Me._toggleMeasure(),n.options.BMHasMeasure=!n.options.BMHasMeasure,we(n.options.BMHasMeasure)}),document.getElementById("headFavPlace").addEventListener("click",function(){Oe("FavTable",0,!1)}),document.getElementById("btPrefCancel").addEventListener("click",function(){be()}),document.getElementById("btPrefSave").addEventListener("click",function(){et()})}function se(){document.getElementById("btEdit").style.display="inline-block",document.getElementById("btEditSave").style.display="none",document.getElementById("btEditCancel").style.display="none",document.getElementById("fTitle").disabled=!0,document.getElementById("fRot").disabled=!0,document.getElementById("fLat").disabled=!0,document.getElementById("fLng").disabled=!0,document.getElementById("fZoom").disabled=!0}function bt(){var e,t,a,o,r;document.getElementById("btEdit").addEventListener("click",function(){e=at(),t=S(),a=N(),o=D(),r=$(),document.getElementById("btEdit").style.display="none",document.getElementById("btEditSave").style.display="inline-block",document.getElementById("btEditCancel").style.display="inline-block",document.getElementById("fTitle").disabled=!1,document.getElementById("fRot").disabled=!1,document.getElementById("fLat").disabled=!1,document.getElementById("fLng").disabled=!1,document.getElementById("fZoom").disabled=!1}),document.getElementById("btEditSave").addEventListener("click",function(){se();var i=document.getElementById("fTitle").value;i!=e&&k(i);var c=Y(document.getElementById("fRot").value);c!=t&&(n.setBearing(c),F(c));var f=nt(document.getElementById("fLat").value),u=it(document.getElementById("fLng").value);(f!=a||u!=o)&&(n.panTo(new L.LatLng(f,u),y),f!=a&&h(f),u!=o&&M(u));var y=st(document.getElementById("fZoom").value);y!=r&&(n.setZoom(y),A(y))}),document.getElementById("btEditCancel").addEventListener("click",function(){se(),document.getElementById("fTitle").value=e,document.getElementById("fRot").value=t})}function Et(e){if(console.log(e),Array.isArray(e.results)&&e.results.length>0){var t=e.results[0],a=t.geometry.lat,o=t.geometry.lng;n.panTo(new L.LatLng(a,o),{}),h(a),M(o)}}function It(){document.getElementById("fSearch").addEventListener("change",function(){var e=document.getElementById("fSearch").value,t="a1f15d3f6b834c55917fd7e435af418c",a=`https://api.opencagedata.com/geocode/v1/json?q=${e}&key=${t}`;console.log(e),fetch(a).then(o=>o.json()).then(o=>Et(o))})}function ee(e,t){g=new L.Marker([e,t],{draggable:!0}),g.bindTooltip(n.options.BMTitle),g.on("dragend",function(a){var o=g.getLatLng().lat,r=g.getLatLng().lng;h(o),M(r)}),n.addLayer(g),n.options.BMHasMarker=!0,G(!0)}function Ce(){var e=n.getCenter().lat,t=n.getCenter().lng;ee(e,t)}function wt(){kt()?R():Ce()}function kt(){var e=!1;return n.eachLayer(t=>{t instanceof L.Marker&&(e=!0)}),e}function R(){n.eachLayer(e=>{e instanceof L.Marker&&e.remove()}),n.options.BMHasMarker=!1,G(!1)}function le(){window.DeviceMotionEvent&&window.DeviceMotionEvent.requestPermission?window.DeviceMotionEvent.requestPermission().then(e=>{e==="granted"&&window.addEventListener("devicemotion",K)}).catch(console.error):window.DeviceOrientationEvent?window.addEventListener("deviceorientationabsolute",K):console.log("Device motion or orientation is not supported by this browser.")}function K(e){let t=null;if(e.rotationRate?t=e.rotationRate.alpha:e.alpha&&(t=e.alpha),t!==null){const a=t;j&&(n.setBearing(a),F(a))}}function Tt(){j=!0,le(),setInterval(le,Ve)}function St(){j=!1,window.DeviceMotionEvent&&window.DeviceMotionEvent.requestPermission?window.removeEventListener("devicemotion",K):window.DeviceOrientationEvent&&window.removeEventListener("deviceorientationabsolute",K)}function ce(){navigator.geolocation?navigator.geolocation.getCurrentPosition(Lt):console.log("Geolocation is not supported by this browser.")}function Lt(e){var t=e.coords.latitude,a=e.coords.longitude;V&&(h(t),M(a),n.panTo({lng:a,lat:t}))}function Ct(){V=!0,ce(),Be=setInterval(ce,1e4)}function Ot(){V=!1,clearInterval(Be)}function xt(){n.options.BMHasTracker?(L.geotagPhoto.crosshair().removeFrom(n),document.querySelectorAll(".leaflet-geotag-photo-crosshair").forEach(t=>t.remove()),Ot(),St()):(L.geotagPhoto.crosshair().addTo(n).on("input",function(e){this.getCrosshairPoint()}),Ct(),Tt()),n.options.BMHasTracker=!n.options.BMHasTracker,ke(n.options.BMHasTracker)}function Oe(e,t,a=!1){const o=document.getElementById(e),r=o.querySelector("tbody"),i=Array.from(r.getElementsByTagName("tr")),c=o.querySelector("thead tr");i.sort((f,u)=>{const y=f.getElementsByTagName("td")[t].textContent.trim(),T=u.getElementsByTagName("td")[t].textContent.trim();return a?T.localeCompare(y):y.localeCompare(T)}),a&&i.reverse(),r.innerHTML="",i.forEach(f=>r.appendChild(f)),o.querySelector("thead").appendChild(c)}
